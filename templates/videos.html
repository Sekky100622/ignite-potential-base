{% extends 'base.html' %}
{% block title %}å‹•ç”»ä¸€è¦§ | ã‚¤ã‚°ãƒ©ã‚¤ãƒˆãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ™ãƒ¼ã‚¹{% endblock %}

{% block content %}
<div class="page-header">
  <div class="container">
    <h1>ğŸ¬ å‹•ç”»ä¸€è¦§</h1>
    <p>ãƒ—ãƒ­ã‚³ãƒ¼ãƒã«ã‚ˆã‚‹å®Ÿè·µå‹•ç”»ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</p>
  </div>
</div>

<section class="section-sm">
  <div class="container">
    <!-- Category filter -->
    <div style="display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:2rem;">
      <a href="{{ url_for('videos') }}"
         class="btn btn-sm {% if not active_category %}btn-primary{% else %}btn-ghost{% endif %}">å…¨ã¦</a>
      {% for cat in categories %}
      <a href="{{ url_for('videos', category=cat.slug) }}"
         class="btn btn-sm {% if active_category == cat.slug %}btn-primary{% else %}btn-ghost{% endif %}">
        {{ cat.name }}
      </a>
      {% endfor %}
    </div>

    {% if videos %}
    <div class="grid grid-3">
      {% for video in videos %}
      <div class="card">
        {% if video.thumbnail_url %}
          <img class="card-img" src="{{ video.thumbnail_url }}" alt="{{ video.title }}">
        {% else %}
          <div class="card-img-placeholder" style="position:relative;">
            <span style="font-size:3rem;">â–¶ï¸</span>
          </div>
        {% endif %}
        <div class="card-body">
          <div style="display:flex;gap:.5rem;margin-bottom:.75rem;flex-wrap:wrap;">
            {% if video.is_free %}
              <span class="badge badge-free">FREE</span>
            {% else %}
              <span class="badge badge-premium">
                {% if not session.get('plan') == 'premium' %}ğŸ”’ {% endif %}PREMIUM
              </span>
            {% endif %}
            {% if video.category %}
              <span class="badge badge-cat">{{ video.category.name }}</span>
            {% endif %}
          </div>
          <h3 style="font-size:1rem;margin-bottom:.5rem;line-height:1.4;">{{ video.title }}</h3>
          {% if video.description %}
            <p class="text-gray text-sm" style="line-height:1.6;">{{ video.description[:80] }}{% if video.description|length > 80 %}...{% endif %}</p>
          {% endif %}
          <div style="margin-top:1rem;">
            <a href="{{ url_for('video_detail', video_id=video.id) }}" class="btn btn-outline btn-sm">
              {% if video.is_free or session.get('plan') == 'premium' %}â–¶ è¦–è´ã™ã‚‹{% else %}ğŸ”’ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼{% endif %}
            </a>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div style="text-align:center;padding:4rem 0;">
      <div style="font-size:3rem;margin-bottom:1rem;">ğŸ“¹</div>
      <h3 style="color:var(--gray-400);">å‹•ç”»ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“</h3>
      {% if session.get('role') == 'admin' %}
        <a href="{{ url_for('admin_videos_new') }}" class="btn btn-primary mt-3">å‹•ç”»ã‚’è¿½åŠ ã™ã‚‹</a>
      {% endif %}
    </div>
    {% endif %}

    {% if not session.get('plan') == 'premium' %}
    <div style="background:linear-gradient(135deg,rgba(249,115,22,.1),transparent);border:1px solid rgba(249,115,22,.25);border-radius:16px;padding:2rem;margin-top:3rem;text-align:center;">
      <h3 style="font-size:1.25rem;margin-bottom:.5rem;">ğŸ¬ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã§å…¨å‹•ç”»ã‚’è§£æ”¾</h3>
      <p class="text-gray text-sm" style="margin-bottom:1.25rem;">æœˆé¡Â¥1,500ã§ã€ãƒ—ãƒ¬ãƒŸã‚¢ãƒ å‹•ç”»ã‚‚ã™ã¹ã¦è¦–è´å¯èƒ½ã€‚</p>
      <a href="{{ url_for('subscribe') }}" class="btn btn-primary">ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã‚’è¦‹ã‚‹</a>
    </div>
    {% endif %}
  </div>
</section>
{% endblock %}
