{% extends 'base.html' %}
{% block title %}{{ video.title }} | ã‚¤ã‚°ãƒ©ã‚¤ãƒˆãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ™ãƒ¼ã‚¹{% endblock %}

{% block content %}
<section class="section-sm">
  <div class="container">
    <!-- Breadcrumb -->
    <div style="color:var(--gray-400);font-size:.85rem;margin-bottom:1.5rem;">
      <a href="{{ url_for('videos') }}" style="color:var(--gray-400);">å‹•ç”»ä¸€è¦§</a>
      {% if video.category %}
        <span style="margin:0 .5rem;">â€º</span>
        <a href="{{ url_for('videos', category=video.category.slug) }}" style="color:var(--gray-400);">{{ video.category.name }}</a>
      {% endif %}
      <span style="margin:0 .5rem;">â€º</span>
      <span style="color:var(--white);">{{ video.title }}</span>
    </div>

    <div style="max-width:860px;margin:0 auto;">
      <!-- Header -->
      <div style="margin-bottom:1.5rem;">
        <div style="display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:.75rem;">
          {% if video.is_free %}
            <span class="badge badge-free">FREE</span>
          {% else %}
            <span class="badge badge-premium">PREMIUM</span>
          {% endif %}
          {% if video.category %}
            <span class="badge badge-cat">{{ video.category.name }}</span>
          {% endif %}
        </div>
        <h1 style="font-size:clamp(1.5rem,3vw,2rem);font-weight:800;line-height:1.3;">{{ video.title }}</h1>
      </div>

      <!-- Video Player -->
      {% if can_view and embed_url %}
        <div style="position:relative;padding-bottom:56.25%;height:0;border-radius:12px;overflow:hidden;background:#000;margin-bottom:1.5rem;">
          <iframe
            src="{{ embed_url }}"
            style="position:absolute;top:0;left:0;width:100%;height:100%;"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen>
          </iframe>
        </div>
      {% elif not can_view %}
        <div style="position:relative;padding-bottom:56.25%;height:0;border-radius:12px;overflow:hidden;background:var(--navy-mid);margin-bottom:1.5rem;">
          <div style="position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:2rem;">
            <div style="font-size:3rem;margin-bottom:1rem;">ğŸ”’</div>
            <h3 style="margin-bottom:.5rem;">ãƒ—ãƒ¬ãƒŸã‚¢ãƒ å‹•ç”»</h3>
            <p class="text-gray text-sm" style="margin-bottom:1.5rem;">ã“ã®å‹•ç”»ã¯ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³é™å®šã§ã™ã€‚</p>
            {% if session.get('user_id') %}
              <a href="{{ url_for('subscribe') }}" class="btn btn-primary">ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰</a>
            {% else %}
              <a href="{{ url_for('register') }}" class="btn btn-primary">ç„¡æ–™ç™»éŒ²ã—ã¦ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰</a>
            {% endif %}
          </div>
        </div>
      {% else %}
        <div style="background:var(--navy-light);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:2rem;text-align:center;margin-bottom:1.5rem;">
          <div style="font-size:2rem;margin-bottom:.5rem;">ğŸ¬</div>
          <p class="text-gray">å‹•ç”»URLãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
        </div>
      {% endif %}

      <!-- Description -->
      {% if video.description %}
      <div style="background:var(--navy-light);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:1.5rem;">
        <h3 style="font-size:1rem;color:var(--gray-400);margin-bottom:.75rem;">å‹•ç”»ã«ã¤ã„ã¦</h3>
        <p style="color:var(--gray-200);line-height:1.8;">{{ video.description }}</p>
      </div>
      {% endif %}

      <div style="margin-top:1.5rem;">
        <a href="{{ url_for('videos') }}" class="btn btn-ghost btn-sm">â† å‹•ç”»ä¸€è¦§ã«æˆ»ã‚‹</a>
      </div>
    </div>
  </div>
</section>
{% endblock %}
